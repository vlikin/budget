"use strict";var app=angular.module("appModule",["LocalStorageModule","ngRoute","MessageCenter"]),app=angular.module("appModule").constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",editor:"editor",guest:"guest"}).constant("SETTINGS",{user:{success_authentication_redirection:"/"}});angular.module("appModule").controller("User-loginController",["$scope","$rootScope","$location","AUTH_EVENTS","AuthService","Lib",function(e,t,o,n,s,r){e.credentials={username:"login",password:"password"},e.login=function(e){s.login(e).then(function(e){t.$broadcast(n.loginSuccess),e.success?(t.$broadcast(n.loginSuccess),o.path(SETTINGS.user.success_authentication_redirection),r.ShowMessage(e.message,"success")):r.ShowMessage(e.message,"warning")},function(){t.$broadcast(n.loginFailed)})}}]).controller("Phone-ListCtrl",["$scope","$http",function(e,t){t.get("/static/app/phones/phones.json").success(function(t){e.phones=t}),e.orderProp="age"}]).controller("Phone-DetailCtrl",["$scope","$routeParams",function(e,t){e.phoneId=t.phoneId}]);var app=angular.module("appModule").factory("AuthService",["$http","Session","USER_ROLES",function(e,t,o){var n={};return n.login=function(n){return e.post("/user/rest/login",n).then(function(e){return e.data.success?(t.create(e.data.id,e.data.user.id,o.admin),e.data):e.data})},n.isAuthenticated=function(){return!!t.userId},n.isAuthorized=function(e){return angular.isArray(e)||(e=[e]),n.isAuthenticated()&&-1!==e.indexOf(t.userRole)},n}]),app=angular.module("appModule").config(["$routeProvider",function(e){e.when("/user/login",{templateUrl:"/static/app/partials/user-login.html",controller:"User-loginController",requires_auth:!1}).when("/phones",{templateUrl:"/static/app/partials/phone-list.html",controller:"Phone-ListCtrl",requires_auth:!0}).when("/phones/:phoneId",{templateUrl:"/static/app/partials/phone-detail.html",controller:"Phone-DetailCtrl",requires_auth:!0}).otherwise({redirectTo:"/phones"})}]).run(["$rootScope","$location","AuthService",function(e,t,o){e.$on("$routeChangeStart",function(e,n){"requires_auth"in n&&n.requires_auth&&!o.isAuthenticated()&&(e.preventDefault(),t.path("/user/login"))})}]);angular.module("appModule").service("Session",function(){return this.create=function(e,t,o){this.id=e,this.userId=t,this.userRole=o},this.destroy=function(){this.id=null,this.userId=null,this.userRole=null},this}).service("Lib",["MessageService",function(e){return this.ShowMessage=function(t,o,n){o="info"|o,n|=!0,e.broadcast(t,{color:o,important:n,classes:"alert alert-error"})},this}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnN0YW50LmpzIiwiY29udHJvbGxlci5qcyIsImZhY3RvcnkuanMiLCJyb3V0ZS5qcyIsInNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQSxJQUFBLEtBQUEsUUFBQSxPQUFBLGFBQ0EscUJBQ0EsVUFDQSxrQkNMQSxJQUFBLFFBQUEsT0FBQSxhQUNBLFNBQUEsZUFDQSxhQUFBLHFCQUNBLFlBQUEsb0JBQ0EsY0FBQSxzQkFDQSxlQUFBLHVCQUNBLGlCQUFBLHlCQUNBLGNBQUEsd0JBRUEsU0FBQSxjQUNBLElBQUEsSUFDQSxNQUFBLFFBQ0EsT0FBQSxTQUNBLE1BQUEsVUFFQSxTQUFBLFlBQ0EsTUFDQSxtQ0FBQSxNQ2pCQSxTQUFBLE9BQUEsYUFFQSxXQUFBLHdCQUFBLFNBQUEsYUFBQSxZQUFBLGNBQUEsY0FBQSxNQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxhQUNBLFNBQUEsUUFDQSxTQUFBLFlBR0EsRUFBQSxNQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFdBQUEsRUFBQSxjQUNBLEVBQUEsU0FDQSxFQUFBLFdBQUEsRUFBQSxjQUNBLEVBQUEsS0FBQSxTQUFBLEtBQUEsb0NBQ0EsRUFBQSxZQUFBLEVBQUEsUUFBQSxZQUdBLEVBQUEsWUFBQSxFQUFBLFFBQUEsWUFFQSxXQUNBLEVBQUEsV0FBQSxFQUFBLG1CQUtBLFdBQUEsa0JBQUEsU0FBQSxRQUNBLFNBQUEsRUFBQSxHQUNBLEVBQUEsSUFBQSxrQ0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsSUFHQSxFQUFBLFVBQUEsU0FHQSxXQUFBLG9CQUFBLFNBQUEsZUFDQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxVQ3BDQSxJQUFBLEtBQUEsUUFBQSxPQUFBLGFBRUEsUUFBQSxlQUFBLFFBQUEsVUFBQSxhQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxLQTJCQSxPQXpCQSxHQUFBLE1BQUEsU0FBQSxHQUNBLE1BQUEsR0FDQSxLQUFBLG1CQUFBLEdBQ0EsS0FBQSxTQUFBLEdBQ0EsTUFBQSxHQUFBLEtBQUEsU0FDQSxFQUFBLE9BQUEsRUFBQSxLQUFBLEdBQUEsRUFBQSxLQUFBLEtBQUEsR0FBQSxFQUFBLE9BQ0EsRUFBQSxNQUdBLEVBQUEsUUFJQSxFQUFBLGdCQUFBLFdBQ0EsUUFBQSxFQUFBLFFBR0EsRUFBQSxhQUFBLFNBQUEsR0FJQSxNQUhBLFNBQUEsUUFBQSxLQUNBLEdBQUEsSUFFQSxFQUFBLG1CQUNBLEtBQUEsRUFBQSxRQUFBLEVBQUEsV0FHQSxLQzlCQSxJQUFBLFFBQUEsT0FBQSxhQUVBLFFBQUEsaUJBQ0EsU0FBQSxHQUNBLEVBQ0EsS0FBQSxlQUNBLFlBQUEsdUNBQ0EsV0FBQSx1QkFDQSxlQUFBLElBRUEsS0FBQSxXQUNBLFlBQUEsdUNBQ0EsV0FBQSxpQkFDQSxlQUFBLElBRUEsS0FBQSxvQkFDQSxZQUFBLHlDQUNBLFdBQUEsbUJBQ0EsZUFBQSxJQUVBLFdBQ0EsV0FBQSxlQUtBLEtBQUEsYUFBQSxZQUFBLGNBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLElBQUEsb0JBQUEsU0FBQSxFQUFBLEdBR0EsaUJBQUEsSUFBQSxFQUFBLGdCQUFBLEVBQUEsb0JBQ0EsRUFBQSxpQkFDQSxFQUFBLEtBQUEsb0JDaENBLFNBQUEsT0FBQSxhQUVBLFFBQUEsVUFBQSxXQVdBLE1BVkEsTUFBQSxPQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsS0FBQSxHQUFBLEVBQ0EsS0FBQSxPQUFBLEVBQ0EsS0FBQSxTQUFBLEdBRUEsS0FBQSxRQUFBLFdBQ0EsS0FBQSxHQUFBLEtBQ0EsS0FBQSxPQUFBLEtBQ0EsS0FBQSxTQUFBLE1BRUEsT0FHQSxRQUFBLE9BQUEsaUJBQUEsU0FBQSxHQU9BLE1BTkEsTUFBQSxZQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxPQUFBLEVBQ0EsSUFBQSxFQUNBLEVBQUEsVUFBQSxHQUFBLE1BQUEsRUFBQSxVQUFBLEVBQUEsUUFBQSx1QkFHQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwTW9kdWxlJywgW1xuICAnTG9jYWxTdG9yYWdlTW9kdWxlJyxcbiAgJ25nUm91dGUnLFxuICAnTWVzc2FnZUNlbnRlcidcbl0pOyIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwTW9kdWxlJylcbi5jb25zdGFudCgnQVVUSF9FVkVOVFMnLCB7XG4gIGxvZ2luU3VjY2VzczogJ2F1dGgtbG9naW4tc3VjY2VzcycsXG4gIGxvZ2luRmFpbGVkOiAnYXV0aC1sb2dpbi1mYWlsZWQnLFxuICBsb2dvdXRTdWNjZXNzOiAnYXV0aC1sb2dvdXQtc3VjY2VzcycsXG4gIHNlc3Npb25UaW1lb3V0OiAnYXV0aC1zZXNzaW9uLXRpbWVvdXQnLFxuICBub3RBdXRoZW50aWNhdGVkOiAnYXV0aC1ub3QtYXV0aGVudGljYXRlZCcsXG4gIG5vdEF1dGhvcml6ZWQ6ICdhdXRoLW5vdC1hdXRob3JpemVkJ1xufSlcbi5jb25zdGFudCgnVVNFUl9ST0xFUycsIHtcbiAgYWxsOiAnKicsXG4gIGFkbWluOiAnYWRtaW4nLFxuICBlZGl0b3I6ICdlZGl0b3InLFxuICBndWVzdDogJ2d1ZXN0J1xufSlcbi5jb25zdGFudCgnU0VUVElOR1MnLCB7XG4gIHVzZXI6IHtcbiAgICBzdWNjZXNzX2F1dGhlbnRpY2F0aW9uX3JlZGlyZWN0aW9uOiAnLydcbiAgfVxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcE1vZHVsZScpXG5cbi5jb250cm9sbGVyKCdVc2VyLWxvZ2luQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgQVVUSF9FVkVOVFMsIEF1dGhTZXJ2aWNlLCBMaWIpIHtcbiAgJHNjb3BlLmNyZWRlbnRpYWxzID0ge1xuICAgIHVzZXJuYW1lOiAnbG9naW4nLFxuICAgIHBhc3N3b3JkOiAncGFzc3dvcmQnXG4gIH07XG5cbiAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKGNyZWRlbnRpYWxzKSB7XG4gICAgQXV0aFNlcnZpY2UubG9naW4oY3JlZGVudGlhbHMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChBVVRIX0VWRU5UUy5sb2dpblN1Y2Nlc3MpO1xuICAgICAgaWYgKGRhdGEuc3VjY2Vzcykge1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoQVVUSF9FVkVOVFMubG9naW5TdWNjZXNzKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoU0VUVElOR1MudXNlci5zdWNjZXNzX2F1dGhlbnRpY2F0aW9uX3JlZGlyZWN0aW9uKTtcbiAgICAgICAgTGliLlNob3dNZXNzYWdlKGRhdGEubWVzc2FnZSwgJ3N1Y2Nlc3MnKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBMaWIuU2hvd01lc3NhZ2UoZGF0YS5tZXNzYWdlLCAnd2FybmluZycpO1xuICAgICAgfVxuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChBVVRIX0VWRU5UUy5sb2dpbkZhaWxlZCk7XG4gICAgfSk7XG4gIH07XG59KVxuXG4uY29udHJvbGxlcignUGhvbmUtTGlzdEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsXG4gIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwKSB7XG4gICAgJGh0dHAuZ2V0KCcvc3RhdGljL2FwcC9waG9uZXMvcGhvbmVzLmpzb24nKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICRzY29wZS5waG9uZXMgPSBkYXRhO1xuICAgIH0pO1xuXG4gICAgJHNjb3BlLm9yZGVyUHJvcCA9ICdhZ2UnO1xuICB9XSlcblxuLmNvbnRyb2xsZXIoJ1Bob25lLURldGFpbEN0cmwnLCBbJyRzY29wZScsICckcm91dGVQYXJhbXMnLFxuICBmdW5jdGlvbigkc2NvcGUsICRyb3V0ZVBhcmFtcykge1xuICAgICRzY29wZS5waG9uZUlkID0gJHJvdXRlUGFyYW1zLnBob25lSWQ7XG4gIH1dKTtcblxuIiwidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHBNb2R1bGUnKVxuXG4uZmFjdG9yeSgnQXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsIFNlc3Npb24sIFVTRVJfUk9MRVMpIHtcbiAgdmFyIGF1dGhTZXJ2aWNlID0ge307XG4gXG4gIGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24gKGNyZWRlbnRpYWxzKSB7XG4gICAgcmV0dXJuICRodHRwXG4gICAgICAucG9zdCgnL3VzZXIvcmVzdC9sb2dpbicsIGNyZWRlbnRpYWxzKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgIFNlc3Npb24uY3JlYXRlKHJlcy5kYXRhLmlkLCByZXMuZGF0YS51c2VyLmlkLCBVU0VSX1JPTEVTLmFkbWluKTtcbiAgICAgICAgICByZXR1cm4gcmVzLmRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzLmRhdGE7XG4gICAgICB9KTtcbiAgfTtcbiBcbiAgYXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAhIVNlc3Npb24udXNlcklkO1xuICB9O1xuIFxuICBhdXRoU2VydmljZS5pc0F1dGhvcml6ZWQgPSBmdW5jdGlvbiAoYXV0aG9yaXplZFJvbGVzKSB7XG4gICAgaWYgKCFhbmd1bGFyLmlzQXJyYXkoYXV0aG9yaXplZFJvbGVzKSkge1xuICAgICAgYXV0aG9yaXplZFJvbGVzID0gW2F1dGhvcml6ZWRSb2xlc107XG4gICAgfVxuICAgIHJldHVybiAoYXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkgJiZcbiAgICAgIGF1dGhvcml6ZWRSb2xlcy5pbmRleE9mKFNlc3Npb24udXNlclJvbGUpICE9PSAtMSk7XG4gIH07XG4gXG4gIHJldHVybiBhdXRoU2VydmljZTtcbn0pOyIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwTW9kdWxlJylcblxuLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlci5cbiAgICAgIHdoZW4oJy91c2VyL2xvZ2luJywge1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9zdGF0aWMvYXBwL3BhcnRpYWxzL3VzZXItbG9naW4uaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdVc2VyLWxvZ2luQ29udHJvbGxlcicsXG4gICAgICAgIHJlcXVpcmVzX2F1dGg6IGZhbHNlXG4gICAgICB9KS5cbiAgICAgIHdoZW4oJy9waG9uZXMnLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL3N0YXRpYy9hcHAvcGFydGlhbHMvcGhvbmUtbGlzdC5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ1Bob25lLUxpc3RDdHJsJyxcbiAgICAgICAgcmVxdWlyZXNfYXV0aDogdHJ1ZVxuICAgICAgfSkuXG4gICAgICB3aGVuKCcvcGhvbmVzLzpwaG9uZUlkJywge1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9zdGF0aWMvYXBwL3BhcnRpYWxzL3Bob25lLWRldGFpbC5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ1Bob25lLURldGFpbEN0cmwnLFxuICAgICAgICByZXF1aXJlc19hdXRoOiB0cnVlXG4gICAgICB9KS5cbiAgICAgIG90aGVyd2lzZSh7XG4gICAgICAgIHJlZGlyZWN0VG86ICcvcGhvbmVzJ1xuICAgICAgfSk7XG4gIH1cbl0pXG5cbi5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUsICRsb2NhdGlvbiwgQXV0aFNlcnZpY2UpIHtcbiAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBjdXJyUm91dGUsIHByZXZSb3V0ZSkge1xuXG4gICAgLy8gSXQgcmVxdWlyZXMgbG9naW4uXG4gICAgaWYgKCdyZXF1aXJlc19hdXRoJyBpbiBjdXJyUm91dGUgJiYgY3VyclJvdXRlLnJlcXVpcmVzX2F1dGggJiYgIUF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgJGxvY2F0aW9uLnBhdGgoJy91c2VyL2xvZ2luJyk7XG4gICAgfVxuICB9KTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHBNb2R1bGUnKVxuXG4uc2VydmljZSgnU2Vzc2lvbicsIGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbiAoc2Vzc2lvbklkLCB1c2VySWQsIHVzZXJSb2xlKSB7XG4gICAgdGhpcy5pZCA9IHNlc3Npb25JZDtcbiAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLnVzZXJSb2xlID0gdXNlclJvbGU7XG4gIH07XG4gIHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmlkID0gbnVsbDtcbiAgICB0aGlzLnVzZXJJZCA9IG51bGw7XG4gICAgdGhpcy51c2VyUm9sZSA9IG51bGw7XG4gIH07XG4gIHJldHVybiB0aGlzO1xufSlcblxuLnNlcnZpY2UoJ0xpYicsIGZ1bmN0aW9uIChNZXNzYWdlU2VydmljZSkge1xuICB0aGlzLlNob3dNZXNzYWdlID0gZnVuY3Rpb24obWVzc2FnZSwgdHlwZSwgaW1wb3J0YW50KSB7XG4gICAgdHlwZSA9IHR5cGUgfCAnaW5mbyc7XG4gICAgaW1wb3J0YW50ID0gaW1wb3J0YW50IHwgdHJ1ZTtcbiAgICBNZXNzYWdlU2VydmljZS5icm9hZGNhc3QobWVzc2FnZSwge2NvbG9yOiB0eXBlLCBpbXBvcnRhbnQ6IGltcG9ydGFudCwgY2xhc3NlczogJ2FsZXJ0IGFsZXJ0LWVycm9yJ30pO1xuICB9O1xuXG4gIHJldHVybiB0aGlzO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9