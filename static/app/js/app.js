"use strict";var app=angular.module("appModule",["LocalStorageModule","ngRoute"]),app=angular.module("appModule").constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",editor:"editor",guest:"guest"});angular.module("appModule").controller("User-loginController",["$scope","$rootScope","AUTH_EVENTS","AuthService",function(e,t,o,n){console.log("init"),e.credentials={username:"login",password:"password"},e.login=function(r){n.login(r).then(function(n){t.$broadcast(o.loginSuccess),e.setCurrentUser(n)},function(){t.$broadcast(o.loginFailed)})}}]).controller("Phone-ListCtrl",["$scope","$http",function(e,t){t.get("/static/app/phones/phones.json").success(function(t){e.phones=t}),e.orderProp="age"}]).controller("Phone-DetailCtrl",["$scope","$routeParams",function(e,t){e.phoneId=t.phoneId}]);var app=angular.module("appModule").factory("AuthService",["$http","Session","USER_ROLES",function(e,t,o){var n={};return n.login=function(n){return e.post("/user/rest/login",n).then(function(e){return console.log(e.data),e.data.success?(t.create(e.data.id,e.data.user.id,o.admin),e.data.user):!1})},n.isAuthenticated=function(){return!!t.userId},n.isAuthorized=function(e){return angular.isArray(e)||(e=[e]),n.isAuthenticated()&&-1!==e.indexOf(t.userRole)},n}]),app=angular.module("appModule").config(["$routeProvider",function(e){e.when("/user/login",{templateUrl:"/static/app/partials/user-login.html",controller:"User-loginController"}).when("/phones",{templateUrl:"/static/app/partials/phone-list.html",controller:"Phone-ListCtrl"}).when("/phones/:phoneId",{templateUrl:"/static/app/partials/phone-detail.html",controller:"Phone-DetailCtrl"}).otherwise({redirectTo:"/phones"})}]);angular.module("appModule").service("Session",function(){return this.create=function(e,t,o){this.id=e,this.userId=t,this.userRole=o},this.destroy=function(){this.id=null,this.userId=null,this.userRole=null},this});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnN0YW50LmpzIiwiY29udHJvbGxlci5qcyIsImZhY3RvcnkuanMiLCJyb3V0ZS5qcyIsInNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQSxJQUFBLEtBQUEsUUFBQSxPQUFBLGFBQ0EscUJBQ0EsWUNKQSxJQUFBLFFBQUEsT0FBQSxhQUNBLFNBQUEsZUFDQSxhQUFBLHFCQUNBLFlBQUEsb0JBQ0EsY0FBQSxzQkFDQSxlQUFBLHVCQUNBLGlCQUFBLHlCQUNBLGNBQUEsd0JBRUEsU0FBQSxjQUNBLElBQUEsSUFDQSxNQUFBLFFBQ0EsT0FBQSxTQUNBLE1BQUEsU0NiQSxTQUFBLE9BQUEsYUFFQSxXQUFBLHdCQUFBLFNBQUEsYUFBQSxjQUFBLGNBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLFFBQUEsSUFBQSxRQUNBLEVBQUEsYUFDQSxTQUFBLFFBQ0EsU0FBQSxZQUdBLEVBQUEsTUFBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLEdBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxXQUFBLEVBQUEsY0FDQSxFQUFBLGVBQUEsSUFDQSxXQUNBLEVBQUEsV0FBQSxFQUFBLG1CQUtBLFdBQUEsa0JBQUEsU0FBQSxRQUNBLFNBQUEsRUFBQSxHQUNBLEVBQUEsSUFBQSxrQ0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsSUFHQSxFQUFBLFVBQUEsU0FHQSxXQUFBLG9CQUFBLFNBQUEsZUFDQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxVQzlCQSxJQUFBLEtBQUEsUUFBQSxPQUFBLGFBRUEsUUFBQSxlQUFBLFFBQUEsVUFBQSxhQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxLQTRCQSxPQTFCQSxHQUFBLE1BQUEsU0FBQSxHQUNBLE1BQUEsR0FDQSxLQUFBLG1CQUFBLEdBQ0EsS0FBQSxTQUFBLEdBRUEsTUFEQSxTQUFBLElBQUEsRUFBQSxNQUNBLEVBQUEsS0FBQSxTQUNBLEVBQUEsT0FBQSxFQUFBLEtBQUEsR0FBQSxFQUFBLEtBQUEsS0FBQSxHQUFBLEVBQUEsT0FDQSxFQUFBLEtBQUEsT0FHQSxLQUlBLEVBQUEsZ0JBQUEsV0FDQSxRQUFBLEVBQUEsUUFHQSxFQUFBLGFBQUEsU0FBQSxHQUlBLE1BSEEsU0FBQSxRQUFBLEtBQ0EsR0FBQSxJQUVBLEVBQUEsbUJBQ0EsS0FBQSxFQUFBLFFBQUEsRUFBQSxXQUdBLEtDL0JBLElBQUEsUUFBQSxPQUFBLGFBRUEsUUFBQSxpQkFDQSxTQUFBLEdBQ0EsRUFDQSxLQUFBLGVBQ0EsWUFBQSx1Q0FDQSxXQUFBLHlCQUVBLEtBQUEsV0FDQSxZQUFBLHVDQUNBLFdBQUEsbUJBRUEsS0FBQSxvQkFDQSxZQUFBLHlDQUNBLFdBQUEscUJBRUEsV0FDQSxXQUFBLGNDbEJBLFNBQUEsT0FBQSxhQUVBLFFBQUEsVUFBQSxXQVdBLE1BVkEsTUFBQSxPQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsS0FBQSxHQUFBLEVBQ0EsS0FBQSxPQUFBLEVBQ0EsS0FBQSxTQUFBLEdBRUEsS0FBQSxRQUFBLFdBQ0EsS0FBQSxHQUFBLEtBQ0EsS0FBQSxPQUFBLEtBQ0EsS0FBQSxTQUFBLE1BRUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcE1vZHVsZScsIFtcbiAgJ0xvY2FsU3RvcmFnZU1vZHVsZScsXG4gICduZ1JvdXRlJyxcbl0pOyIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwTW9kdWxlJylcbi5jb25zdGFudCgnQVVUSF9FVkVOVFMnLCB7XG4gIGxvZ2luU3VjY2VzczogJ2F1dGgtbG9naW4tc3VjY2VzcycsXG4gIGxvZ2luRmFpbGVkOiAnYXV0aC1sb2dpbi1mYWlsZWQnLFxuICBsb2dvdXRTdWNjZXNzOiAnYXV0aC1sb2dvdXQtc3VjY2VzcycsXG4gIHNlc3Npb25UaW1lb3V0OiAnYXV0aC1zZXNzaW9uLXRpbWVvdXQnLFxuICBub3RBdXRoZW50aWNhdGVkOiAnYXV0aC1ub3QtYXV0aGVudGljYXRlZCcsXG4gIG5vdEF1dGhvcml6ZWQ6ICdhdXRoLW5vdC1hdXRob3JpemVkJ1xufSlcbi5jb25zdGFudCgnVVNFUl9ST0xFUycsIHtcbiAgYWxsOiAnKicsXG4gIGFkbWluOiAnYWRtaW4nLFxuICBlZGl0b3I6ICdlZGl0b3InLFxuICBndWVzdDogJ2d1ZXN0J1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcE1vZHVsZScpXG5cbi5jb250cm9sbGVyKCdVc2VyLWxvZ2luQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnQVVUSF9FVkVOVFMnLCAnQXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBBVVRIX0VWRU5UUywgQXV0aFNlcnZpY2UpIHtcbiAgY29uc29sZS5sb2coJ2luaXQnKTtcbiAgJHNjb3BlLmNyZWRlbnRpYWxzID0ge1xuICAgIHVzZXJuYW1lOiAnbG9naW4nLFxuICAgIHBhc3N3b3JkOiAncGFzc3dvcmQnXG4gIH07XG4gIFxuICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoY3JlZGVudGlhbHMpIHtcbiAgICBBdXRoU2VydmljZS5sb2dpbihjcmVkZW50aWFscykudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luU3VjY2Vzcyk7XG4gICAgICAkc2NvcGUuc2V0Q3VycmVudFVzZXIodXNlcik7XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KEFVVEhfRVZFTlRTLmxvZ2luRmFpbGVkKTtcbiAgICB9KTtcbiAgfTtcbn1dKVxuXG4uY29udHJvbGxlcignUGhvbmUtTGlzdEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsXG4gIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwKSB7XG4gICAgJGh0dHAuZ2V0KCcvc3RhdGljL2FwcC9waG9uZXMvcGhvbmVzLmpzb24nKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICRzY29wZS5waG9uZXMgPSBkYXRhO1xuICAgIH0pO1xuXG4gICAgJHNjb3BlLm9yZGVyUHJvcCA9ICdhZ2UnO1xuICB9XSlcblxuLmNvbnRyb2xsZXIoJ1Bob25lLURldGFpbEN0cmwnLCBbJyRzY29wZScsICckcm91dGVQYXJhbXMnLFxuICBmdW5jdGlvbigkc2NvcGUsICRyb3V0ZVBhcmFtcykge1xuICAgICRzY29wZS5waG9uZUlkID0gJHJvdXRlUGFyYW1zLnBob25lSWQ7XG4gIH1dKTtcblxuIiwidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHBNb2R1bGUnKVxuXG4uZmFjdG9yeSgnQXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsIFNlc3Npb24sIFVTRVJfUk9MRVMpIHtcbiAgdmFyIGF1dGhTZXJ2aWNlID0ge307XG4gXG4gIGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24gKGNyZWRlbnRpYWxzKSB7XG4gICAgcmV0dXJuICRodHRwXG4gICAgICAucG9zdCgnL3VzZXIvcmVzdC9sb2dpbicsIGNyZWRlbnRpYWxzKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7XG4gICAgICAgIGlmIChyZXMuZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgU2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEuaWQsIHJlcy5kYXRhLnVzZXIuaWQsIFVTRVJfUk9MRVMuYWRtaW4pO1xuICAgICAgICAgIHJldHVybiByZXMuZGF0YS51c2VyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG4gIH07XG4gXG4gIGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gISFTZXNzaW9uLnVzZXJJZDtcbiAgfTtcbiBcbiAgYXV0aFNlcnZpY2UuaXNBdXRob3JpemVkID0gZnVuY3Rpb24gKGF1dGhvcml6ZWRSb2xlcykge1xuICAgIGlmICghYW5ndWxhci5pc0FycmF5KGF1dGhvcml6ZWRSb2xlcykpIHtcbiAgICAgIGF1dGhvcml6ZWRSb2xlcyA9IFthdXRob3JpemVkUm9sZXNdO1xuICAgIH1cbiAgICByZXR1cm4gKGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpICYmXG4gICAgICBhdXRob3JpemVkUm9sZXMuaW5kZXhPZihTZXNzaW9uLnVzZXJSb2xlKSAhPT0gLTEpO1xuICB9O1xuIFxuICByZXR1cm4gYXV0aFNlcnZpY2U7XG59KTsiLCJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcE1vZHVsZScpXG5cbi5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICB3aGVuKCcvdXNlci9sb2dpbicsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvc3RhdGljL2FwcC9wYXJ0aWFscy91c2VyLWxvZ2luLmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnVXNlci1sb2dpbkNvbnRyb2xsZXInXG4gICAgICB9KS5cbiAgICAgIHdoZW4oJy9waG9uZXMnLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL3N0YXRpYy9hcHAvcGFydGlhbHMvcGhvbmUtbGlzdC5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ1Bob25lLUxpc3RDdHJsJ1xuICAgICAgfSkuXG4gICAgICB3aGVuKCcvcGhvbmVzLzpwaG9uZUlkJywge1xuICAgICAgICB0ZW1wbGF0ZVVybDogJy9zdGF0aWMvYXBwL3BhcnRpYWxzL3Bob25lLWRldGFpbC5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ1Bob25lLURldGFpbEN0cmwnXG4gICAgICB9KS5cbiAgICAgIG90aGVyd2lzZSh7XG4gICAgICAgIHJlZGlyZWN0VG86ICcvcGhvbmVzJ1xuICAgICAgfSk7XG4gIH1cbl0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHBNb2R1bGUnKVxuXG4uc2VydmljZSgnU2Vzc2lvbicsIGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbiAoc2Vzc2lvbklkLCB1c2VySWQsIHVzZXJSb2xlKSB7XG4gICAgdGhpcy5pZCA9IHNlc3Npb25JZDtcbiAgICB0aGlzLnVzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLnVzZXJSb2xlID0gdXNlclJvbGU7XG4gIH07XG4gIHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmlkID0gbnVsbDtcbiAgICB0aGlzLnVzZXJJZCA9IG51bGw7XG4gICAgdGhpcy51c2VyUm9sZSA9IG51bGw7XG4gIH07XG4gIHJldHVybiB0aGlzO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9